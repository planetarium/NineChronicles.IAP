{% extends "base.html" %}

{% block title %}Product ê´€ë¦¬{% endblock %}

{% block content %}
<div class="container">
    <h1 class="mb-4">Product ê´€ë¦¬</h1>

    <!-- Product ëª©ë¡ í…Œì´ë¸” -->
    <table class="table table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>ì´ë¦„</th>
                <th>Google SKU</th>
                <th>Apple SKU</th>
                <th>ìƒíƒœ</th>
                <th>ê´€ë¦¬</th>
            </tr>
        </thead>
        <tbody>
            {% for product in products %}
            <tr>
                <td>{{ product.id }}</td>
                <td>{{ product.name }}</td>
                <td>{{ product.google_sku }}</td>
                <td>{{ product.apple_sku }}</td>
                <td>
                    {% if product.active %}
                        <span class="badge bg-success">âœ… í™œì„±</span>
                    {% else %}
                        <span class="badge bg-danger">âŒ ë¹„í™œì„±</span>
                    {% endif %}
                </td>
                <td>
                    <button class="btn btn-warning btn-sm" onclick="editProduct('{{ product.id }}', '{{ product.name }}', '{{ product.google_sku }}', '{{ product.apple_sku }}', '{{ product.product_type }}', '{{ product.active|lower }}', '{{ product.discount }}')">âœï¸ ìˆ˜ì •</button>
                    <a href="/products/delete/{{ product.id }}" class="btn btn-danger btn-sm"
                       onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">ğŸ—‘ ì‚­ì œ</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- ì¶”ê°€ ë²„íŠ¼ -->
    <button class="btn btn-primary mt-3" onclick="showAddForm()">â• ìƒˆ Product ì¶”ê°€</button>

    <!-- Product ì¶”ê°€/ìˆ˜ì • í¼ -->
    <div id="product-form" class="card shadow p-4 mt-4 d-none">
        <h2 class="mb-4" id="form-title">ìƒˆ Product ì¶”ê°€</h2>
        
        <form method="post" action="/products/save">
            <input type="hidden" name="id" id="product-id">

            <div class="mb-3">
                <label class="form-label">ì´ë¦„</label>
                <input type="text" name="name" id="product-name" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Google SKU</label>
                <input type="text" name="google_sku" id="product-google-sku" class="form-control">
            </div>

            <div class="mb-3">
                <label class="form-label">Apple SKU</label>
                <input type="text" name="apple_sku" id="product-apple-sku" class="form-control">
            </div>

            <div class="mb-3">
                <label class="form-label">Product íƒ€ì…</label>
                <input type="text" name="product_type" id="product-type" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">í• ì¸ìœ¨ (%)</label>
                <input type="number" step="0.01" name="discount" id="product-discount" class="form-control">
            </div>

            <div class="mb-3">
                <label class="form-label">í™œì„±í™”</label>
                <div class="form-check">
                    <input type="checkbox" name="active" id="product-active" class="form-check-input">
                    <label class="form-check-label">ì´ ì œí’ˆ í™œì„±í™”</label>
                </div>
            </div>

            <div class="text-center">
                <button type="submit" class="btn btn-success">ğŸ’¾ ì €ì¥</button>
                <button type="button" class="btn btn-secondary" onclick="hideForm()">ì·¨ì†Œ</button>
            </div>
        </form>
    </div>
</div>

<!-- JavaScript -->
<script>
    function showAddForm() {
        document.getElementById('form-title').innerText = "ìƒˆ Product ì¶”ê°€";
        document.getElementById('product-id').value = "";
        document.getElementById('product-name').value = "";
        document.getElementById('product-google-sku').value = "";
        document.getElementById('product-apple-sku').value = "";
        document.getElementById('product-type').value = "";
        document.getElementById('product-discount').value = "0";
        document.getElementById('product-active').checked = false;
        document.getElementById('product-form').classList.remove('d-none');
    }

    function editProduct(id, name, googleSku, appleSku, productType, active, discount) {
        document.getElementById('form-title').innerText = "Product ìˆ˜ì •";
        document.getElementById('product-id').value = id;
        document.getElementById('product-name').value = name;
        document.getElementById('product-google-sku').value = googleSku;
        document.getElementById('product-apple-sku').value = appleSku;
        document.getElementById('product-type').value = productType;
        document.getElementById('product-discount').value = discount;
        document.getElementById('product-active').checked = active;
        document.getElementById('product-form').classList.remove('d-none');
    }

    function hideForm() {
        document.getElementById('product-form').classList.add('d-none');
    }
</script>
{% endblock %}
